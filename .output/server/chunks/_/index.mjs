import{h as e,d as t,t as n}from"./client.DwfV9Oyl.mjs";import{b as r,c as o}from"./router.mjs";const guard=(e,t)=>{const _guard=e=>{};try{const t=e();return(e=>e instanceof Promise)(t)?t.catch(_guard):t}catch(e){return}};var s,i,a,c,d,u;(i=s||(s={}))["7bit"]="7bit",i["8bit"]="8bit",i.Base64="base64",i.Binary="binary",i.IETFToken="ietf-token",i.QuotedPrintable="quoted-printable",i.XToken="x-token",(c=a||(a={})).Date="date",c.DateTime="date-time",c.Duration="duration",c.Email="email",c.Hostname="hostname",c.IDNEmail="idn-email",c.IDNHostname="idn-hostname",c.IPv4="ipv4",c.IPv6="ipv6",c.IRI="iri",c.IRIReference="iri-reference",c.JSONPointer="json-pointer",c.JSONPointerURIFragment="json-pointer-uri-fragment",c.RegEx="regex",c.RelativeJSONPointer="relative-json-pointer",c.Time="time",c.URI="uri",c.URIReference="uri-reference",c.URITemplate="uri-template",c.UUID="uuid",(u=d||(d={})).Array="array",u.Boolean="boolean",u.Integer="integer",u.Null="null",u.Number="number",u.Object="object",u.String="string";var p=(e=>(e.BigInt="bigint",e.RegExp="regexp",e.Date="date",e.Url="url",e.Set="set",e.Map="map",e))(p||{});class experimental_ZodSmartCoercionPlugin{init(e){e.clientInterceptors??=[],e.clientInterceptors.unshift(e=>{const t=e.procedure["~orpc"].inputSchema;if(!t||"zod"!==t["~standard"].vendor||!("_zod"in t))return e.next();const n=this.#e(t,e.input);return e.next({...e,input:n})})}#e(e,n){switch(e._zod.def.type){case"number":return"string"==typeof n?this.#t(n):n;case"bigint":return"string"==typeof n?this.#n(n):n;case"boolean":case"success":return"string"==typeof n?this.#r(n):n;case"date":return"string"==typeof n?this.#o(n):n;case"literal":case"enum":{const t=e;if(!t._zod.values.has(n)&&"string"==typeof n){const e=this.#t(n);if(t._zod.values.has(e))return e;const r=this.#r(n);if(t._zod.values.has(r))return r;const o=this.#n(n);if(t._zod.values.has(o))return o}return n}case"array":{const t=e;return void 0===n?[]:Array.isArray(n)?n.map(e=>this.#e(t._zod.def.element,e)):n}case"tuple":{const t=e;return void 0===n?[]:Array.isArray(n)?n.map((e,n)=>{const r=t._zod.def.items[n]??t._zod.def.rest;return r?this.#e(r,e):e}):n}case"set":{const t=e;return void 0===n?new Set:Array.isArray(n)?new Set(n.map(e=>this.#e(t._zod.def.valueType,e))):n instanceof Set?new Set(Array.from(n).map(e=>this.#e(t._zod.def.valueType,e))):n}case"object":{const r=e;if(void 0===n)return{};if(t(n)){const e={},t=new Set([...Object.keys(n),...Object.keys(r._zod.def.shape)]);for(const o of t){const t=r._zod.def.shape[o]??r._zod.def.catchall;e[o]=t?this.#e(t,n[o]):n[o]}return e}return n}case"record":{const r=e;if(void 0===n)return{};if(t(n)){const e={};for(const[t,o]of Object.entries(n)){const n=this.#e(r._zod.def.keyType,t),s=this.#e(r._zod.def.valueType,o);e[n]=s}return e}return n}case"map":{const t=e;return void 0===n?new Map:Array.isArray(n)&&n.every(e=>Array.isArray(e)&&e.length<=2)?new Map(n.map(([e,n])=>[this.#e(t._zod.def.keyType,e),this.#e(t._zod.def.valueType,n)])):n instanceof Map?new Map(Array.from(n).map(([e,n])=>[this.#e(t._zod.def.keyType,e),this.#e(t._zod.def.valueType,n)])):n}case"union":{const r=e;if(1===r._zod.def.options.length)return this.#e(r._zod.def.options[0],n);if(t(n)){const e="discriminator"in r._zod.def&&"string"==typeof r._zod.def.discriminator?r._zod.def.discriminator:void 0;for(const t of r._zod.def.options)if(t._zod.propValues)if(void 0!==e){if(t._zod.propValues[e]?.has(n[e]))return this.#e(t,n)}else for(const e in t._zod.propValues)if(t._zod.propValues[e]?.has(n[e]))return this.#e(t,n)}return n}case"intersection":{const t=e;return this.#e(t._zod.def.right,this.#e(t._zod.def.left,n))}case"optional":{const t=e;if(void 0===n)return;return this.#e(t._zod.def.innerType,n)}case"nonoptional":{const t=e;return this.#e(t._zod.def.innerType,n)}case"nullable":{const t=e;return null===n?null:this.#e(t._zod.def.innerType,n)}case"readonly":{const t=e;return this.#e(t._zod.def.innerType,n)}case"pipe":{const t=e;return this.#e(t._zod.def.in,n)}case"default":case"prefault":{const t=e;return void 0===n?n:this.#e(t._zod.def.innerType,n)}case"catch":{const t=e;return this.#e(t._zod.def.innerType,n)}case"lazy":{const t=e;return void 0!==n?this.#e(t._zod.def.getter(),n):n}default:return e._zod.def.type,n}}#t(e){const t=Number(e);return Number.isNaN(t)||t.toString()!==e?e:t}#n(e){return guard(()=>BigInt(e))??e}#r(e){const t=e.toLowerCase();return"false"!==t&&"off"!==t&&"f"!==t&&("true"===t||"on"===t||"t"===t||e)}#o(e){const t=new Date(e);return!Number.isNaN(t.getTime())&&t.toISOString().startsWith(e)?t:e}}const m=r(),f=r(),h=r();class ZodToJsonSchemaConverter{maxLazyDepth;maxStructureDepth;anyJsonSchema;unsupportedJsonSchema;undefinedJsonSchema;interceptors;constructor(e={}){this.maxLazyDepth=e.maxLazyDepth??2,this.maxStructureDepth=e.maxStructureDepth??10,this.anyJsonSchema=e.anyJsonSchema??{},this.unsupportedJsonSchema=e.unsupportedJsonSchema??{not:{}},this.undefinedJsonSchema=e.undefinedJsonSchema??{not:{}},this.interceptors=e.interceptors??[]}condition(e){return void 0!==e&&"zod"===e["~standard"].vendor&&"_zod"in e}convert(e,t){return this.#s(e,t,0,0)}#s(t,r,o,s,i=!1){return e(this.interceptors,{schema:t,options:r,lazyDepth:o,isHandledCustomJSONSchema:i},({schema:e,options:t,lazyDepth:r,isHandledCustomJSONSchema:o})=>{if(s>this.maxStructureDepth)return[!1,this.anyJsonSchema];if(!t.minStructureDepthForRef||t.minStructureDepthForRef<=s){const r=n(t.components);for(const n of r)if(n.schema===e&&n.allowedStrategies.includes(t.strategy))return[n.required,{$ref:n.ref}]}if(!o){const n=this.#i(e,t);if(n){const[o,i]=this.#s(e,t,r,s,!0);return[o,{...i,...n}]}}switch(e._zod.def.type){case"string":{const t=e,n={type:"string"},{minimum:r,maximum:o,format:s,patterns:i,contentEncoding:a}=t._zod.bag;if("number"==typeof r&&(n.minLength=r),"number"==typeof o&&(n.maxLength=o),"string"==typeof a&&(n.contentEncoding=this.#a(a)),"string"==typeof s&&"regex"!==s&&void 0===n.contentEncoding&&(n.format=this.#c(s)),i instanceof Set&&void 0===n.contentEncoding&&void 0===n.format)for(const e of i)void 0===n.pattern?n.pattern=e.source:(n.allOf??=[],n.allOf.push({pattern:e.source}));return"jwt"===s&&void 0===n.contentEncoding&&void 0===n.format&&void 0===n.pattern&&(n.pattern=/^[\w-]+\.[\w-]+\.[\w-]+$/.source),[!0,n]}case"number":{const t=e,n={type:"number"},{minimum:r,maximum:o,format:s,multipleOf:i,exclusiveMaximum:a,exclusiveMinimum:c}=t._zod.bag;return"string"==typeof s&&s?.includes("int")&&(n.type="integer"),"number"==typeof r&&(n.minimum=r),"number"==typeof o&&(n.maximum=o),"number"==typeof c&&(n.exclusiveMinimum=c),"number"==typeof a&&(n.exclusiveMaximum=a),"number"==typeof i&&(n.multipleOf=i),[!0,n]}case"boolean":case"success":return[!0,{type:"boolean"}];case"bigint":return[!0,{type:"string",pattern:"^-?[0-9]+$","x-native-type":p.BigInt}];case"date":return[!0,{type:"string",format:a.DateTime,"x-native-type":p.Date}];case"null":return[!0,{type:"null"}];case"undefined":case"void":return[!1,this.undefinedJsonSchema];case"any":case"unknown":case"transform":return[!1,this.anyJsonSchema];case"never":return[!0,this.unsupportedJsonSchema];case"array":{const n=e,o={type:"array"},{minimum:i,maximum:a}=n._zod.bag;return"number"==typeof i&&(o.minItems=i),"number"==typeof a&&(o.maxItems=a),o.items=this.#d(this.#s(n._zod.def.element,t,r,s+1),t),[!0,o]}case"object":{const n=e,o={type:"object"};for(const[e,i]of Object.entries(n._zod.def.shape)){const[n,a]=this.#s(i,t,r,s+1);o.properties??={},o.properties[e]=a,n&&(o.required??=[],o.required.push(e))}if(n._zod.def.catchall)if("never"===n._zod.def.catchall._zod.def.type)o.additionalProperties=!1;else{const[e,i]=this.#s(n._zod.def.catchall,t,r,s+1);o.additionalProperties=i}return[!0,o]}case"union":{const n=e,o=[];let i=!0;for(const e of n._zod.def.options){const[n,a]=this.#s(e,t,r,s);n||(i=!1),"input"===t.strategy?a!==this.undefinedJsonSchema&&a!==this.unsupportedJsonSchema&&o.push(a):a!==this.undefinedJsonSchema&&o.push(a)}return[i,1===o.length?o[0]:{anyOf:o}]}case"intersection":{const n=e,o={allOf:[]};let i=!1;for(const e of[n._zod.def.left,n._zod.def.right]){const[n,a]=this.#s(e,t,r,s);o.allOf.push(a),n&&(i=!0)}return[i,o]}case"tuple":{const n=e,o={type:"array",prefixItems:[]};for(const e of n._zod.def.items)o.prefixItems.push(this.#d(this.#s(e,t,r,s+1),t));n._zod.def.rest&&(o.items=this.#d(this.#s(n._zod.def.rest,t,r,s+1),t));const{minimum:i,maximum:a}=n._zod.bag;return"number"==typeof i&&(o.minItems=i),"number"==typeof a&&(o.maxItems=a),[!0,o]}case"record":{const n=e,o={type:"object"};return o.propertyNames=this.#s(n._zod.def.keyType,t,r,s+1)[1],o.additionalProperties=this.#s(n._zod.def.valueType,t,r,s+1)[1],[!0,o]}case"map":{const n=e;return[!0,{type:"array",items:{type:"array",prefixItems:[this.#d(this.#s(n._zod.def.keyType,t,r,s+1),t),this.#d(this.#s(n._zod.def.valueType,t,r,s+1),t)],maxItems:2,minItems:2},"x-native-type":p.Map}]}case"set":{const n=e;return[!0,{type:"array",uniqueItems:!0,items:this.#d(this.#s(n._zod.def.valueType,t,r,s+1),t),"x-native-type":p.Set}]}case"enum":{const t=e;return[!0,{enum:Object.values(t._zod.def.entries)}]}case"literal":{const t=e;let n=!0;const r=new Set;for(const e of t._zod.def.values)void 0===e?n=!1:r.add("bigint"==typeof e?e.toString():e);return[n,0===r.size?this.undefinedJsonSchema:1===r.size?{const:r.values().next().value}:{enum:Array.from(r)}]}case"file":{const t=e,n=[],{mime:r}=t._zod.bag;if(void 0===r||Array.isArray(r)&&r.every(e=>"string"==typeof e))for(const e of r??["*/*"])n.push({type:"string",contentMediaType:e});return[!0,1===n.length?n[0]:{anyOf:n}]}case"nullable":{const n=e,[o,i]=this.#s(n._zod.def.innerType,t,r,s);return[o,{anyOf:[i,{type:"null"}]}]}case"nonoptional":{const n=e,[,o]=this.#s(n._zod.def.innerType,t,r,s);return[!0,o]}case"default":case"prefault":{const n=e,[,o]=this.#s(n._zod.def.innerType,t,r,s);return[!1,{...o,default:n._zod.def.defaultValue}]}case"catch":{const n=e;return this.#s(n._zod.def.innerType,t,r,s)}case"nan":return[!0,"input"===t.strategy?this.unsupportedJsonSchema:{type:"null"}];case"pipe":{const n=e;return this.#s("input"===t.strategy?n._zod.def.in:n._zod.def.out,t,r,s)}case"readonly":{const n=e,[o,i]=this.#s(n._zod.def.innerType,t,r,s);return[o,{...i,readOnly:!0}]}case"template_literal":return[!0,{type:"string",pattern:e._zod.pattern.source}];case"optional":{const n=e,[,o]=this.#s(n._zod.def.innerType,t,r,s);return[!1,o]}case"lazy":{const n=e,o=r+1;return o>this.maxLazyDepth?[!1,this.anyJsonSchema]:this.#s(n._zod.def.getter(),t,o,s)}default:return e._zod.def.type,[!0,this.unsupportedJsonSchema]}})}#i(e,t){if("input"===t.strategy&&f.has(e))return f.get(e);if("output"===t.strategy&&h.has(e))return h.get(e);if(m.has(e))return m.get(e);const n=o.get(e);return n?{title:n.title,description:n.description,examples:Array.isArray(n.examples)?n.examples:void 0}:void 0}#d([e,t],n){return e||"input"===n.strategy||void 0!==t.default?t:t===this.undefinedJsonSchema?{type:"null"}:{anyOf:[t,{type:"null"}]}}#c(e){return"guid"===e?a.UUID:"url"===e?a.URI:"datetime"===e?a.DateTime:Object.values(a).includes(e)?e:void 0}#a(e){return Object.values(s).includes(e)?e:void 0}}export{d as T,ZodToJsonSchemaConverter as Z,experimental_ZodSmartCoercionPlugin as e};
//# sourceMappingURL=index.mjs.map
