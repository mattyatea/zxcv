{"version":3,"file":"oauthSecurity.mjs","sources":["../../../../server/utils/oauthSecurity.ts"],"sourcesContent":null,"names":["OAUTH_CONFIG","STATE_EXPIRATION","MAX_PENDING_STATES_PER_IP","OAUTH_RATE_LIMIT","windowMs","maxRequests","validateRedirectUrl","url","allowedDomains","parsedUrl","URL","startsWith","some","domain","baseDomain","slice","hostname","endsWith","async","performOAuthSecurityChecks","db","clientIp","locale","oAuthState","findMany","where","expiresAt","gte","Math","floor","Date","now","length","ORPCError","message","authErrors","tooManyOAuthAttempts","generateNonce","array","Uint8Array","crypto","getRandomValues","Array","from","byte","toString","padStart","join","validateOAuthResponse","params","error","messageKey","access_denied","invalid_request","unauthorized_client","unsupported_response_type","invalid_scope","server_error","temporarily_unavailable","t","error_description","code","state"],"mappings":"kQAKO,MAAMA,EAAe,CAE3BC,iBAAkB,IAElBC,0BAA2B,EAE3BC,iBAAkB,CACjBC,SAAU,IACVC,YAAa,KAOR,SAASC,oBAAoBC,EAAaC,GAChD,IACC,MAAMC,EAAY,IAAIC,IAAIH,GAG1B,SAAIA,EAAII,WAAW,MAASJ,EAAII,WAAW,QAKpCH,EAAeI,KAAMC,IAC3B,GAAIA,EAAOF,WAAW,MAAO,CAE5B,MAAMG,EAAaD,EAAOE,MAAM,GAChC,OAAON,EAAUO,WAAaF,GAAcL,EAAUO,SAASC,SAAS,IAAIH,IAC7E,CACA,OAAOL,EAAUO,WAAaH,GAEhC,CAAA,MAEC,OAAO,CACR,CACD,CAKAK,eAAsBC,2BACrBC,EACAC,EACAC,EAAiB,MAajB,UAV4BF,EAAGG,WAAWC,SAAS,CAClDC,MAAO,CACNJ,WACAK,UAAW,CACVC,IAAKC,KAAKC,MAAMC,KAAKC,MAAQ,UAISC,QAEfhC,EAAaE,0BACtC,MAAM,IAAI+B,EAAU,oBAAqB,CACxCC,QAASC,EAAWC,qBAAqBd,IAG5C,CAKO,SAASe,gBACf,MAAMC,EAAQ,IAAIC,WAAW,IAE7B,OADAC,OAAOC,gBAAgBH,GAChBI,MAAMC,KAAKL,EAAQM,GAASA,EAAKC,SAAS,IAAIC,SAAS,EAAG,MAAMC,KAAK,GAC7E,CAKO,SAASC,sBACfC,EAMA3B,EAAiB,MAGjB,GAAI2B,EAAOC,MAAO,CACjB,MAUMC,EAVsC,CAC3CC,cAAe,4BACfC,gBAAiB,8BACjBC,oBAAqB,kCACrBC,0BAA2B,uCAC3BC,cAAe,4BACfC,aAAc,2BACdC,wBAAyB,uCAGKT,EAAOC,OAChChB,EAAUiB,EACbQ,EAAER,EAAY7B,GACd2B,EAAOW,mBAAqBD,EAAE,0BAA2BrC,GAE5D,MAAM,IAAIW,EAAU,cAAe,CAClCC,WAEF,CAGA,IAAKe,EAAOY,OAASZ,EAAOa,MAC3B,MAAM,IAAI7B,EAAU,cAAe,CAClCC,QAASyB,EAAE,6BAA8BrC,KAK3C,GAAI2B,EAAOY,KAAK7B,OAAS,IAAMiB,EAAOY,KAAK7B,OAAS,KACnD,MAAM,IAAIC,EAAU,cAAe,CAClCC,QAASyB,EAAE,2BAA4BrC,KAIzC,GAAI2B,EAAOa,MAAM9B,OAAS,IAAMiB,EAAOa,MAAM9B,OAAS,KACrD,MAAM,IAAIC,EAAU,cAAe,CAClCC,QAASyB,EAAE,4BAA6BrC,IAG3C"}