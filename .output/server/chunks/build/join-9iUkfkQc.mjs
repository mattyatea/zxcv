import{_ as t}from"./LoadingSpinner-DwDpbgSM.mjs";import{_ as e}from"./nuxt-link-4uLnvjVp.mjs";import{_ as r}from"./Button-BAc5buFc.mjs";import{u as a}from"./useToast-CcSWCLuS.mjs";import{u as o}from"./auth-DJ_gFT6B.mjs";import{v as i,u as n,b as s,a as l,s as d}from"./server.mjs";import{B as u,z as g,C as m}from"../routes/renderer.mjs";import"../nitro/nitro.mjs";import"node:events";import"node:process";import"cloudflare:workers";import"node:buffer";import"node:timers";import"@prisma/client";import"node:util";import"./_plugin-vue_export-helper-1tPrXgE0.mjs";import"./toast-DzkE1rsh.mjs";import"node:zlib";import"node:stream";import"node:url";import"node:net";import"node:path";import"../_/index4.mjs";import"../_/client.DwfV9Oyl.mjs";import"../_/shared.esm-bundler.mjs";const c=i.defineComponent({__name:"join",__ssrInlineRender:!0,setup(c){const{t:p}=n(),v=s(),{$rpc:x}=l(),f=o(),{isAuthenticated:j}=d(f),{error:h}=a(),y=i.ref(!1),k=i.ref(""),z=i.ref(!1),b=i.ref(null),w=i.computed(()=>v.query.token);return i.watch(j,t=>{t&&w.value&&!z.value&&!k.value&&(async()=>{if(w.value){y.value=!0,k.value="";try{const t=await x.organizations.acceptInvitation({token:w.value});z.value=!0,b.value=t.organization}catch(t){const e=t instanceof Error?t.message:p("organizations.join.failed");k.value=e,h(e)}finally{y.value=!1}}else k.value=p("organizations.join.noToken")})()}),(a,o,n,s)=>{var l,d,c;const p=t,v=e,x=r;o(`<div${u(i.mergeProps({class:"min-h-screen bg-gray-50 dark:bg-gray-950 flex items-center justify-center px-4"},s))}><div class="max-w-md w-full">`),y.value?(o('<div class="text-center">'),o(g(p,{size:"lg"},null,n)),o(`<p class="mt-4 text-gray-600 dark:text-gray-400">${m(a.$t("organizations.join.verifying"))}</p></div>`)):k.value?(o(`<div class="text-center"><div class="w-16 h-16 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center mx-auto mb-4"><svg class="w-8 h-8 text-red-600 dark:text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></div><h2 class="text-2xl font-bold text-gray-900 dark:text-gray-100 mb-2">${m(a.$t("organizations.join.failed"))}</h2><p class="text-gray-600 dark:text-gray-400 mb-6">${m(k.value)}</p>`),o(g(v,{to:"/organizations"},{default:i.withCtx((t,e,r,o)=>{if(!e)return[i.createVNode(x,{variant:"primary"},{default:i.withCtx(()=>[i.createTextVNode(i.toDisplayString(a.$t("organizations.join.backToOrganizations")),1)]),_:1})];e(g(x,{variant:"primary"},{default:i.withCtx((t,e,r,o)=>{if(!e)return[i.createTextVNode(i.toDisplayString(a.$t("organizations.join.backToOrganizations")),1)];e(`${m(a.$t("organizations.join.backToOrganizations"))}`)}),_:1},r,o))}),_:1},n)),o("</div>")):z.value?(o(`<div class="text-center"><div class="w-16 h-16 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center mx-auto mb-4"><svg class="w-8 h-8 text-green-600 dark:text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></div><h2 class="text-2xl font-bold text-gray-900 dark:text-gray-100 mb-2">${m(a.$t("organizations.join.joined"))}</h2><p class="text-gray-600 dark:text-gray-400 mb-6">${m((null==(l=b.value)?void 0:l.displayName)||(null==(d=b.value)?void 0:d.name))} ${m(a.$t("organizations.join.welcome"))}</p>`),o(g(v,{to:`/organizations/${null==(c=b.value)?void 0:c.id}`},{default:i.withCtx((t,e,r,o)=>{if(!e)return[i.createVNode(x,{variant:"primary"},{default:i.withCtx(()=>[i.createTextVNode(i.toDisplayString(a.$t("organizations.join.goToOrganization")),1)]),_:1})];e(g(x,{variant:"primary"},{default:i.withCtx((t,e,r,o)=>{if(!e)return[i.createTextVNode(i.toDisplayString(a.$t("organizations.join.goToOrganization")),1)];e(`${m(a.$t("organizations.join.goToOrganization"))}`)}),_:1},r,o))}),_:1},n)),o("</div>")):i.unref(j)?o("\x3c!----\x3e"):(o(`<div class="text-center"><div class="w-16 h-16 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center mx-auto mb-4"><svg class="w-8 h-8 text-blue-600 dark:text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path></svg></div><h2 class="text-2xl font-bold text-gray-900 dark:text-gray-100 mb-2">${m(a.$t("organizations.join.loginRequired"))}</h2><p class="text-gray-600 dark:text-gray-400 mb-6">${m(a.$t("organizations.join.loginToJoin"))}</p>`),o(g(v,{to:`/login?redirect=/organizations/join?token=${i.unref(w)}`},{default:i.withCtx((t,e,r,o)=>{if(!e)return[i.createVNode(x,{variant:"primary"},{default:i.withCtx(()=>[i.createTextVNode(i.toDisplayString(a.$t("organizations.join.login")),1)]),_:1})];e(g(x,{variant:"primary"},{default:i.withCtx((t,e,r,o)=>{if(!e)return[i.createTextVNode(i.toDisplayString(a.$t("organizations.join.login")),1)];e(`${m(a.$t("organizations.join.login"))}`)}),_:1},r,o))}),_:1},n)),o("</div>")),o("</div></div>")}}}),p=c.setup;c.setup=(t,e)=>{const r=i.useSSRContext();return(r.modules||(r.modules=new Set)).add("pages/organizations/join.vue"),p?p(t,e):void 0};export{c as default};
//# sourceMappingURL=join-9iUkfkQc.mjs.map
