{"version":3,"file":"_..._.mjs","sources":["../../../../../server/routes/rpc/[...].ts"],"sourcesContent":null,"names":["handler","RPCHandler","router","plugins","interceptors","onError","error","console","log","isORPCError","ORPCError","code","message","_____","defineEventHandler","async","event","_a","_b","method","node","req","url","path","context","cloudflare","testEnv","DB","globalThis","R2","EMAIL_SENDER","KV_CACHE","JWT_SECRET","JWT_ALGORITHM","JWT_EXPIRES_IN","EMAIL_FROM","FRONTEND_URL","RATE_LIMIT_ANONYMOUS","RATE_LIMIT_AUTHENTICATED","RATE_LIMIT_API_KEY","env","waitUntil","passThroughOnException","props","request","Request","user","authorization","getHeader","startsWith","token","substring","payload","verifyJWT","id","sub","email","username","emailVerified","getAuthUser","URL","headers","host","Headers","key","value","Object","entries","set","Array","isArray","join","String","rawBody","readRawBody","body","response","toString","handle","prefix","handlerError","stack","matched","status","setResponseStatus","forEach","setHeader","contentType","get","includes","json","text","constructor","name","Response","errorResponse","orpcError","UNAUTHORIZED","FORBIDDEN","NOT_FOUND","BAD_REQUEST","CONFLICT","INTERNAL_SERVER_ERROR","defined","data"],"mappings":"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"}